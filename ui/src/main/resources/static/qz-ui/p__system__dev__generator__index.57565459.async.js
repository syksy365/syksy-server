"use strict";(self.webpackChunkqing_zhou=self.webpackChunkqing_zhou||[]).push([[510],{45215:function(e,r,n){n.r(r),n.d(r,{default:function(){return ee}});var t=n(25359),a=n.n(t),i=n(49811),o=n.n(i),l=n(54306),s=n.n(l),u=n(59496),c=n(81347),p=n(64993),d=n(26659),f=n(69030),m=n(54689),x=n.n(m),h=n(37188),v=n(3984),b=n(25389);function y(){return(y=o()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/generator/code",{method:"PUT",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var j={},C=n(4637),g=h.Z.TabPane;n(13190),n(98356),n(722),n(14006),n(38215),n(98395);var w=function(e){var r=(0,u.useState)(),n=s()(r,2),t=n[0],a=n[1],i=(0,u.useState)({controller:"",domain:"",service:"",mapper:"",xml:""}),o=s()(i,2),l=o[0],c=o[1],p=function(e,r){l[r]!=e&&(l[r]=e)};(0,u.useEffect)((function(){!function(e){if(void 0!==e){a(e);var r,n=x()(e);try{for(n.s();!(r=n.n()).done;){var t=r.value;p(t.content,t.genre)}}catch(e){n.e(e)}finally{n.f()}c(Object.assign({},l))}}(e.sourceCode)}),[e.sourceCode]);var f=(0,u.useState)(!1),m=s()(f,2),b=m[0],w=m[1];return(0,C.jsxs)(h.Z,{style:{backgroundColor:"white",padding:"0px"},className:j,tabBarExtraContent:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(d.Z,{size:"small",onClick:function(){c({controller:"",domain:"",service:"",mapper:"",xml:""}),a({})},style:{marginRight:"8px"},children:"重置"},"resetCode"),(0,C.jsx)(d.Z,{size:"small",type:"primary",loading:b,onClick:function(){w(!0);var e,r=x()(t);try{for(r.s();!(e=r.n()).done;){var n=e.value;n.content=l[n.genre]}}catch(e){r.e(e)}finally{r.f()}(function(e){return y.apply(this,arguments)})(t).then((function(){w(!1)}))},children:"保存"},"saveCode")]}),children:[-1!=e.typeCheck.indexOf("controller")&&(0,C.jsx)(g,{tab:"controller",children:(0,C.jsx)(v.Rt,{value:l.controller,options:{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,styleActiveLine:!0,coverGutterNextToScrollbar:!1},onChange:function(e,r,n){return p(n,"controller")}})},"controller"),-1!=e.typeCheck.indexOf("service")&&(0,C.jsx)(g,{tab:"service",children:(0,C.jsx)(v.Rt,{value:l.service,options:{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,styleActiveLine:!0,coverGutterNextToScrollbar:!1},onChange:function(e,r,n){return p(n,"service")}})},"service"),-1!=e.typeCheck.indexOf("domain")&&(0,C.jsx)(g,{tab:"domain",children:(0,C.jsx)(v.Rt,{value:l.domain,options:{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,styleActiveLine:!0,coverGutterNextToScrollbar:!1},onChange:function(e,r,n){return p(n,"domain")}})},"domain"),-1!=e.typeCheck.indexOf("mapper")&&(0,C.jsx)(g,{tab:"mapper",children:(0,C.jsx)(v.Rt,{value:l.mapper,options:{mode:"text/x-java",theme:"eclipse",lineNumbers:!0,styleActiveLine:!0,coverGutterNextToScrollbar:!1},onChange:function(e,r,n){return p(n,"mapper")}})},"mapper"),-1!=e.typeCheck.indexOf("xml")&&(0,C.jsx)(g,{tab:"xml",children:(0,C.jsx)(v.Rt,{value:l.xml,options:{mode:"xml",theme:"eclipse",lineNumbers:!0,styleActiveLine:!0,coverGutterNextToScrollbar:!1},onChange:function(e,r,n){return p(n,"xml")}})},"xml")]})},k=n(83069),N=n(6333);function S(e){return I.apply(this,arguments)}function I(){return(I=o()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/generator/code/preview",{method:"POST",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=function(e){var r=(0,u.useRef)(),n=(0,u.useState)(!1),t=s()(n,2),i=t[0],l=t[1],c=(0,u.useState)(!1),p=s()(c,1)[0];(0,u.useEffect)((function(){var n;null==r||null===(n=r.current)||void 0===n||n.setFieldsValue(e.value)}),[e.value]);var f=function(){},m=function(){var n;null==r||null===(n=r.current)||void 0===n||n.validateFields().then(function(){var r=o()(a()().mark((function r(n){var t;return a()().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return l(!0),r.next=3,S(n);case 3:t=r.sent,e.onPreview(t.data),l(!1);case 6:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())};return(0,C.jsxs)(k.t,{formRef:r,onFinish:o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),submitter:{render:function(){return[(0,C.jsx)(d.Z,{type:"primary",loading:i,onClick:m,children:"预览"},"pv"),(0,C.jsx)(d.Z,{type:"dashed",loading:p,onClick:f,children:"直接生成"},"dg")]}},defaultCollapsed:!1,children:[(0,C.jsx)(N.Z,{name:"tableName",label:"表名",hidden:!0,rules:[{required:!0}]}),-1!=e.typeCheck.indexOf("controller")&&(0,C.jsx)(N.Z,{name:"controllerName",label:"controller",rules:[{required:!0}]}),-1!=e.typeCheck.indexOf("service")&&(0,C.jsx)(N.Z,{name:"serviceName",label:"service",rules:[{required:!0}]}),-1!=e.typeCheck.indexOf("domain")&&(0,C.jsx)(N.Z,{name:"domainName",label:"domain",rules:[{required:!0}]}),(-1!=e.typeCheck.indexOf("mapper")||-1!=e.typeCheck.indexOf("xml"))&&(0,C.jsx)(N.Z,{name:"mapperName",label:"mapper",rules:[{required:!0}]})]})},T=n(44698),q="table___KNtu2";function O(){return P.apply(this,arguments)}function P(){return(P=o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/database/tables",{method:"GET"}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=function(e){var r=(0,u.useState)(),n=s()(r,2),t=n[0],i=n[1],l=function(){var e=o()(a()().mark((function e(){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:r=e.sent,i(r.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){l()}),[]);return(0,C.jsx)("div",{children:(0,C.jsx)(T.Rs,{className:q,pagination:{defaultPageSize:10,hideOnSinglePage:!0,size:"small",simple:!0},tableAlertRender:!1,toolBarRender:!1,size:"small",rowKey:"tableName",dataSource:t,split:!0,rowSelection:{type:"radio",onSelect:function(r){!function(r){e.onSelect(r)}(r)}},metas:{title:{dataIndex:"tableName"},description:{dataIndex:"tableComment"}}})})},_=n(74958),R=n(97823),z=n(12683),D=n(51089),E=n(57213),G=n.n(E),U=n(30582),V=n(65686),F=n(86061),L=n(61506),Y=n(57025);function B(){return(B=o()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/generator/configuration/list",{params:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){return M.apply(this,arguments)}function M(){return(M=o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/generator/configuration"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return X.apply(this,arguments)}function X(){return(X=o()(a()().mark((function e(r){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,b.request)("/qz/api/generator/configuration",{method:"PUT",data:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var H=n(1618),J=n(30264),W=function(e){var r=e.modalVisible,n=e.onVisibleChange,t=e.saveCallBack,i=(0,u.useState)(),l=s()(i,2),c=l[0],p=l[1],d=(0,u.useState)(),f=s()(d,2),m=f[0],x=f[1],h=(0,u.useRef)(),v=[{title:"作者",dataIndex:"author",width:"50px",filters:!1},L.Z.EXPAND_COLUMN,{title:"表前缀",dataIndex:"tablePrefix",width:"70px",filters:!1},{title:"组id",dataIndex:"groupId",filters:!1}];return(0,C.jsx)("div",{children:(0,C.jsx)(V.Y,{title:"公开配置",modalProps:{maskClosable:!1},width:768,visible:r,onVisibleChange:function(e){return n(e)},onFinish:o()(a()().mark((function e(){return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(m&&t(m),!0));case 1:case"end":return e.stop()}}),e)}))),children:(0,C.jsx)(F.Z,{search:!1,actionRef:h,tableAlertRender:!1,rowSelection:{type:"radio",onSelect:function(e){x(e)}},expandable:{expandedRowRender:function(e){return function(e){return(0,C.jsxs)(U.vY,{column:2,children:[(0,C.jsx)(U.vY.Item,{label:"聚合模块",children:e.moduleName}),(0,C.jsx)(U.vY.Item,{label:"组下包",children:e.groupPackage}),(0,C.jsx)(U.vY.Item,{label:"时间类型",children:e.dateType}),(0,C.jsx)(U.vY.Item,{label:"主键类型",children:e.idType}),(0,C.jsx)(U.vY.Item,{span:2,label:"生成文件",children:(0,C.jsx)(Y.Z.Group,{options:["controller","domain","service","mapper","xml"],disabled:!0,defaultValue:e.fileType})})]})}(e)},expandIcon:function(e){var r=e.expanded,n=e.onExpand,t=e.record;return r?(0,C.jsx)(H.Z,{onClick:function(e){return n(t,e)}}):(0,C.jsx)(J.Z,{onClick:function(e){return n(t,e)}})}},rowKey:"userId",request:function(e,r,n){return function(e){return B.apply(this,arguments)}(G()(G()({},e),{},{sorter:r,filter:n})).then((function(e){return e.data}))},columns:v,pagination:{pageSize:10},params:c,toolbar:{search:{defaultValue:null==c?void 0:c.author,allowClear:!0,placeholder:"请输入作者名",onSearch:function(e){p({author:e})}}}})})})},$=function(e){var r=(0,u.useRef)(),n=function(){var e=o()(a()().mark((function e(){var n,t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:t=e.sent,null==r||null===(n=r.current)||void 0===n||n.setFieldsValue(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t=(0,u.useState)(!1),i=s()(t,2),l=i[0],c=i[1];(0,u.useEffect)((function(){n()}),[n]);var p=function(){var n=o()(a()().mark((function n(){var t;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:null==r||null===(t=r.current)||void 0===t||t.validateFields().then(o()(a()().mark((function n(){var t,i;return a()().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=null==r||null===(t=r.current)||void 0===t?void 0:t.getFieldsValue(),n.next=3,Q(i);case 3:e.updateCallBack();case 4:case"end":return n.stop()}}),n)}))));case 1:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),f=function(){var e=o()(a()().mark((function e(n){var t;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.fileType=n.fileType.split(","),null==r||null===(t=r.current)||void 0===t||t.setFieldsValue(n);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(_.A,{formRef:r,submitter:{render:function(){return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(d.Z,{style:{marginRight:"8px"},onClick:function(){return c(!0)},children:"选择公开配置"}),(0,C.jsx)(d.Z,{type:"primary",onClick:function(){return p()},children:"更新"})]})}},children:[(0,C.jsx)(R.Z,{name:"open",label:"公开配置"}),(0,C.jsx)(N.Z,{width:"sm",name:"author",label:"作者",rules:[{required:!0}]}),(0,C.jsx)(N.Z,{width:"sm",name:"moduleName",label:"聚合模块",tooltip:"如果项目是采用Maven聚合模式，则输入子模块名称，否则无需填写"}),(0,C.jsx)(N.Z,{width:"sm",name:"groupId",label:"组ID",rules:[{required:!0}],tooltip:"Maven项目src/main/java下的自定义路径，一般为Maven的Group ID"}),(0,C.jsx)(N.Z,{width:"sm",name:"groupPackage",label:"组下包",tooltip:"组ID下需要分多个文件夹（包），则输入当前组下包名称，否则无需填写"}),(0,C.jsx)(N.Z,{width:"sm",name:"tablePrefix",label:"表前缀",tooltip:"生成文件名去除表前缀"}),(0,C.jsx)(z.Z.Group,{rules:[{required:!0}],width:"sm",name:"dateType",label:"时间类型",tooltip:"TIME_PACK：java.time；ONLY_DATE：java.util.date；SQL_PACK：java.sql；",options:["TIME_PACK","ONLY_DATE","SQL_PACK"],fieldProps:{defaultValue:"TIME_PACK"}}),(0,C.jsx)(z.Z.Group,{rules:[{required:!0}],name:"idType",label:"主键类型",tooltip:"ASSIGN_ID：雪花算法；ASSIGN_ID：UUID；以上两种只有当插入对象ID 为空，才自动填充；AUTO： 数据库ID自增；INPUT：用户输入ID；NONE：该类型为未设置主键类型(注解里等于跟随全局,全局里约等于 INPUT)",options:["ASSIGN_ID","ASSIGN_UUID","AUTO","NONE","INPUT"],fieldProps:{defaultValue:"ASSIGN_ID"}}),(0,C.jsx)(D.Z.Group,{rules:[{required:!0}],name:"fileType",label:"生成文件",tooltip:"选择生成文件类型",options:["controller","domain","service","mapper","xml"]})]}),(0,C.jsx)(W,{onVisibleChange:function(e){return c(e)},modalVisible:l,saveCallBack:f})]})},ee=function(){var e=(0,u.useState)(),r=s()(e,2),n=r[0],t=r[1],i=(0,u.useState)([]),l=s()(i,2),m=l[0],x=l[1],h=(0,u.useState)(!1),v=s()(h,2),b=v[0],y=v[1],j=(0,u.useState)(),g=s()(j,2),k=g[0],N=g[1],S=(0,u.useState)(),I=s()(S,2),T=I[0],q=I[1],O=function(){var e=o()(a()().mark((function e(){var r;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:(r=e.sent).data.fileType&&x(r.data.fileType),N(r.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){O()}),[]);return(0,C.jsx)(p.ZP,{children:(0,C.jsxs)(c.Z,{split:"vertical",children:[(0,C.jsx)(c.Z,{title:"数据库表",extra:(0,C.jsx)(d.Z,{type:"primary",size:"small",children:"刷新"},"primary"),bordered:!0,headerBordered:!0,colSpan:{xs:"50px",sm:"100px",md:"200px",lg:"250px",xl:"300px"},children:(0,C.jsx)(A,{onSelect:function(e){t(function(e,r){var n={controllerName:"",serviceName:"",domainName:"",mapperName:"",tableName:e},t=e.replace(r.tablePrefix,""),a=t.split("");"_"!=a[0]&&(a[0]=a[0].toUpperCase());for(var i=0;i<a.length;i++)"_"==a[i]&&(a[i+1]=a[i+1].toUpperCase()),t=a.join("");var o=t.replace(/_/g,"");return-1!=r.fileType.indexOf("controller")&&(n.controllerName=o+"Controller"),-1!=r.fileType.indexOf("service")&&(n.serviceName=o+"Service"),-1!=r.fileType.indexOf("domain")&&(n.domainName=o+"DO"),-1!=r.fileType.indexOf("mapper")&&(n.mapperName=o+"Mapper"),n}(e.tableName,k))}})}),(0,C.jsxs)(c.Z,{title:"代码",extra:(0,C.jsx)(d.Z,{type:"primary",size:"small",onClick:function(){y(!0)},children:"设置"},"primary"),bordered:!0,headerBordered:!0,direction:"column",gutter:[0,16],children:[(0,C.jsx)(c.Z,{type:"inner",bordered:!0,children:(0,C.jsx)(Z,{value:n,typeCheck:m,onPreview:function(e){q(e)}})}),(0,C.jsx)(c.Z,{type:"inner",bordered:!0,children:(0,C.jsx)(w,{typeCheck:m,sourceCode:T})})]}),(0,C.jsx)(f.Z,{width:520,placement:"right",destroyOnClose:!0,closable:!1,onClose:function(){y(!1)},visible:b,children:(0,C.jsx)($,{updateCallBack:function(){O(),y(!1)}})})]})})}}}]);